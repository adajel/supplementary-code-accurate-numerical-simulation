# BDF2 time stepping scheme #

This directory contains an implementation of a numerical DG1/CG2 scheme for
    solving the Mori model in the zero flow limit with two compartments
    (neurons and ECS) and Na, K, Cl. CSD is stimulated by excitatory fluxes.
    Numerical scheme: BDF2 for time stepping, ESDIRK4 for ODE time stepping
    (can be altered in solve_BDF2.py) and a Strang or a Godenov splitting
    scheme.

### Dependencies ###

To get the environment needed (all dependencies etc.) to run the code, download
the docker container by running for the MMS test:

    docker run -t -v $(pwd):/home/fenics -i quay.io/fenicsproject/stable:2017.1.0

or for the convergence test and CSD simulations:

    docker run -t -v $(pwd):/home/fenics -i quay.io/fenicsproject/stable

Note that plotting requires LaTex.

### Usage ###

Each numerical experiment can be run by the run_*.py files, i.e.:

    python run_convergence_test_strang.py

    python run_MMS_test_1D_ODE.py

To plot all state variables from the results generated by
run_convergence_test_godunov.py in time and space, run:

    plot_CSD.py

### Files ###

* *run_convergence_test_strang.py*  
    Run convergence test with a CSD wave using Strang splitting

    - Output: generates table with values for wave speed (table_wavespeed.txt), width
        of wave (table_wavewidth.txt), duration of wave (table_duration.txt) and
        plots of neuronal potential (*.png).

* *run_mms_test_1D_ODE.py*  
    Run method of manufactured solutions (MMS) test for coupled PDEs and ODEs
    on a 1D mesh.

    - Output: tables with errors (L2 and H1 when applicable) for the state variables

* *plot_CSD.py*  
    Plot results from CSD simulation (gerenerted by run_convergence_test_godunov.py)

    - Output: generates time and space plots for all state variables

* *solver_BDF2.py*  
    Contains class for a FEM solver for the mori model.  Numerical scheme: BDF2
    for time stepping, ESDIRK4 for ODE time stepping (can be altered in
    solve_BDF2.py) and a Strang (solve_system_strange()) or Godenov
    splitting scheme (solve_system_godenov()).

* *mms_1D_ODE.py*  
    Contains MMS problem used in run_mms_test_1D_ODE.py.

* *problem_base.py*  
    Contains class for problem base, specifying model parameters, initial
    conditions, membrane model (ODEs and/or algebraic expressions).

* *problems.py*  
    Contains class for problems, specifying triggering mechanism (excitatory
    fluxes).

* *plotter.py*  
    Contains class for plotting.

### License ###

The software is free: you can redistribute it and/or modify it under the terms
of the GNU Lesser General Public License as published by the Free Software
Foundation, either version 3 of the License, or (at your option) any later
version.

### Community ###

Contact ada@simula.no for questions or to report issues with the software.
